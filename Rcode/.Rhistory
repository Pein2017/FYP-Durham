data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
data1$interpolated_acetic[ which(data1$interpolated_acetic < 0 )] = 0
remove_col = c()
for (j in 1:dim(data1)[2] )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
names(data1)
data1 = cbind(data,  interpolated_formic = interpolated_formic$y , interpolated_acetic=interpolated_acetic$y ,)
data1 = cbind(data,  interpolated_formic = interpolated_formic$y , interpolated_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
data1$interpolated_acetic[ which(data1$interpolated_acetic < 0 )] = 0
remove_col = c()
for (j in 1:dim(data1)[2] )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
cor( ac$formic , ac$acetic )
plot( ac$formic , ac$acetic)
cor( ac$formic , ac$acetic )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1)
points( ac$EFT , ac$formic , col = 2 )
cor( ac$formic , ac$acetic )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = acids)
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids')
points( ac$EFT , ac$formic , col = 2 )
cor( ac$formic , ac$acetic )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids' , main = 'acid values')
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
data1$EFT..Hours
data1$EFT..Hours[,nrows(data1)]
data1$EFT..Hours[,nrow(data1)]
data1$EFT..Hours[nrow(data1)]
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated_acetic = spline(x = x ,y = y , xout = x_out )
interpolated_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__accacetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
data1$interpolated_acetic[ which(data1$interpolated_acetic < 0 )] = 0
data1
data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
data1 =  data1[complete.cases(data1) ,]
data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:dim(data1)[2] )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
summary(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__accacetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:dim(data1)[2] )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
summary(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__accacetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(nrow(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(nrow(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
j
nrow(data1)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__accacetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
slr = lm( interpolated__acc_acetic ~., data= data1)
summary(slr)
data1$headspace.pressure
mean(data1$headspace.pressure)
data1 = dplyr:: filter( data1 , EFT..Hours < 360) %<% select( -headspace.pressure )
library(tidyverse)
data1 = dplyr:: filter( data1 , EFT..Hours < 360) %<% select( -headspace.pressure )
data1 = select( -headspace.pressure )
data1 = data1[, -"headspace.pressure"]
data1 = data1[, -headspace.pressure]
names(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 = data1[,-45]  ## constant headspace.pressure
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
slr = lm( interpolated__acc_acetic ~., data= data1)
summary(slr)
names(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 = data1[,-45]  ## constant headspace.pressure
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
#data1 = data1[,-45]  ## constant headspace.pressure
names(data1)
data1 = data1[,-49]  ## constant headspace.pressure
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
slr = lm( interpolated__acc_acetic ~., data= data1)
summary(slr)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
data1 = data1[,-49]  ## constant headspace.pressure
names(data1)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
index = which( names(data1) == 'headspace.pressure')
index
data1 = data1[,-index]  ## constant headspace.pressure
names(data1)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data1 = dplyr:: filter( data1 , EFT..Hours < 360)
index = which( names(data1) == 'headspace.pressure')
data1 = data1[,-index]  ## constant headspace.pressure
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
slr = lm( interpolated__acc_acetic ~., data= data1)
summary(slr)
plot(slr)
slr = step( lm( interpolated__acc_acetic ~., data= data1) )
summary(slr)
plot(slr)
cov( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
cov( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids' , main = 'acid values')
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
#data = read.csv( "C:/Users/85212/Desktop/Pro-Data/main.csv" ,header=TRUE)
data = read.csv("C:/Users/85212/Desktop/Pro-Data/online.csv", header=TRUE)
#names(data) = c( 'Sample.Key',names(data)[-1] )
#data = data[-1,]
data= data[,-2]
colnames(data)[1]='EFT..Hours'
#names(data)
ac = read.csv( "C:/Users/85212/Desktop/Pro-Data/acids.csv" ,header=TRUE)
#names(ac) = c( 'Date',names(ac)[-1] )
ac = dplyr:: filter( ac , EFT..Hours < 360)
#names(ac) = c( 'Date',names(ac)[-1] )
ac = dplyr:: filter( ac , EFT < 360)
ac$EFT
cov( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids' , main = 'acid values')
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
slr = step( lm( interpolated__acc_acetic ~., data= data1) )
summary(slr)
plot(slr)
#data = read.csv( "C:/Users/85212/Desktop/Pro-Data/main.csv" ,header=TRUE)
data = read.csv("C:/Users/85212/Desktop/Pro-Data/online.csv", header=TRUE)
#names(data) = c( 'Sample.Key',names(data)[-1] )
#data = data[-1,]
data= data[,-2]
colnames(data)[1]='EFT..Hours'
#names(data)
ac = read.csv( "C:/Users/85212/Desktop/Pro-Data/acids.csv" ,header=TRUE)
#names(ac) = c( 'Date',names(ac)[-1] )
ac = dplyr:: filter( ac , EFT < 360)
data = dplyr:: filter( data , EFT..Hours < 360)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
data$EFT..Hours
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated_acetic$y )
dim(data)
length(interpolated__acc_acetic)
length(interpolated__acc_acetic$y)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated__acc_acetic$y )
# data1 = dplyr:: filter( data1 , EFT..Hours < 360)
index = which( names(data1) == 'headspace.pressure')
data1 = data1[,-index]  ## constant headspace.pressure
dim(data1)
install.packages('tinytex')
install.packages('rmarkdown')
install.packages('tinytex')
install_tinytex()  #这个很重要，90M的压缩包
install.packages("rmarkdown")
install.packages('rmarkdown')
install.packages('tinytex')
install_tinytex()  #这个很重要，90M的压缩包
tinytex::install_tinytex()
knitr::opts_chunk$set(echo = TRUE)
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic )
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids' , main = 'acid values')
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic , col = 3 , main = 'formic VS acetic, seems to be independent'')
plot( ac$EFT , ac$acetic, col = 1 , ylab = 'acids' , main = 'acid values' )
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic , col = 3 , main = 'formic VS acetic, seems to be independent'')
plot( ac$EFT , ac$acetic,main = 'acid values' ,col = 1 , ylab = 'acids'  )
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic , col = 3 , main = 'formic VS acetic, seems to be independent'')
plot( ac$EFT , ac$acetic, main = 'acid values' , col = c(1) , ylab = 'acids '  )
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic , col = 3 , main = 'formic VS acetic, seems to be independent')
plot( ac$EFT , ac$acetic, main = 'acid values' , col = 3 , ylab = 'acids '  )
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
names(data1)
cat( as.vector( names(data1)) )
cat(names(data10))
cat(names(data1))
cat(names(data1),sep = ',')
cat(names(data1),sep = '  ,')
cat(names(data1),sep = '|||')
print( names(data1),sep = '|||')
knitr::opts_chunk$set(echo = TRUE)
#data = read.csv( "C:/Users/85212/Desktop/Pro-Data/main.csv" ,header=TRUE)
data = read.csv("C:/Users/85212/Desktop/Pro-Data/online.csv", header=TRUE)
#names(data) = c( 'Sample.Key',names(data)[-1] )
#data = data[-1,]
data= data[,-2]
colnames(data)[1]='EFT..Hours'
#names(data)
ac = read.csv( "C:/Users/85212/Desktop/Pro-Data/acids.csv" ,header=TRUE)
#names(ac) = c( 'Date',names(ac)[-1] )
ac = dplyr:: filter( ac , EFT < 360)
data = dplyr:: filter( data , EFT..Hours < 360)
x = ac$EFT
y = ac$Acc.rate.acetic
x_out = data$EFT..Hours
interpolated__acc_acetic = spline(x = x ,y = y , xout = x_out )
interpolated__acc_formic = spline( x = x , y = ac$Acc.rate.formic , xout = x_out)
data1 = cbind(data,  interpolated_formic = interpolated__acc_formic$y , interpolated__acc_acetic=interpolated__acc_acetic$y )
# data1 = dplyr:: filter( data1 , EFT..Hours < 360)
index = which( names(data1) == 'headspace.pressure')
data1 = data1[,-index]  ## remove constant headspace.pressure
names(data1)
data1 =  data1[complete.cases(data1) ,]
#data1$interpolated_acc_acetic[ which(data1$interpolated__acc_acetic < 0 )] = 0
remove_col = c()
for (j in 1:(ncol(data1)-2) )
{
if (  mean(data1[,j]) < 0.01 | min(data1[,j])  == mean(data1[,j])  )
remove_col = c(remove_col , j)
else
{
wrong_row = which(data1[,j] < 0 )
data1[wrong_row , j] = 0
}
data1 = data1[,-remove_col]
#summary(data1)
cor.test( ac$formic , ac$acetic )
summary(  lm(ac$formic~ac$acetic ) )
plot( ac$formic , ac$acetic , col = 3 , main = 'formic VS acetic, seems to be independent')
plot( ac$EFT , ac$acetic, main = 'acid values' , col = 1 , ylab = 'acids '  )
points( ac$EFT , ac$formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
plot( ac$EFT , ac$Acc.rate.acetic, col = 1 , ylab = 'acids' , main = 'acc rate')
points( ac$EFT , ac$Acc.rate.formic , col = 2 )
legend("topright", inset=.05, c('acetic','formic'),lty=c(1, 1), pch=c(1, 1), col=c(1, 2))
